Everything here was copy-pasted from TypeScript's source code.